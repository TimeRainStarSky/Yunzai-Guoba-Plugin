import{a as e,b as a,r as l,fZ as t,w as i,z as s,I as o,e as u,o as n,f as v,k as d,j as r,v as c,l as p,O as m,i as f,da as b,F as h,h as g,W as y,m as w,s as x,M as k,f_ as B,d0 as _,d1 as L,aL as C}from"./index.js";import M from"./IconUploader2.js";import"./esm.js";const j=(e=>(_("data-v-2d6b3d56"),e=e(),L(),e))((()=>c("span",{class:"tip"},"按住这里可拖动",-1))),I={class:"icon-view-wrap"},R={class:"icon-view"},A=["onClick"];var S=e(a({__name:"SelectIconModal",props:{visible:Boolean,cell:Object,iconB64List:Array},emits:["update:visible"],setup(e,{emit:a}){const _=e,L=a,{createMessage:S}=C(),$=l(!1),z=l({show:!1,selected:null}),O=()=>{L("update:visible",!1)},U=()=>{$.value=!$.value,$.value&&B.info("请点击想要替换的图标")},D=l(null),{x:F,y:N,isDragging:T}=t(D),V=l(0),W=l(0),Z=l(!1),q=l(0),E=l(0),G=l(0),H=l(0),J=l({left:0,right:0,top:0,bottom:0});i([F,N],(()=>{if(!Z.value){V.value=F.value,W.value=N.value;const e=document.body.getBoundingClientRect(),a=D.value.getBoundingClientRect();J.value.right=e.width-a.width,J.value.bottom=e.height-a.height,G.value=q.value,H.value=E.value}Z.value=!0})),i(T,(()=>{T||(Z.value=!1)})),s((()=>{Z.value&&(q.value=G.value+Math.min(Math.max(J.value.left,F.value),J.value.right)-V.value,E.value=H.value+Math.min(Math.max(J.value.top,N.value),J.value.bottom)-W.value)}));const K=o((()=>({transform:`translate(${q.value}px, ${E.value}px)`})));function P(){let e=_.iconB64List,a=!1;for(let l=1;l<e.length;l++)if(!e[l]){a=!0;break}a?S.warn("仍有未利用的空白图标，无法继续添加"):e.push(...Array(10).fill(""))}return(a,l)=>{const t=u("a-button"),i=u("a-space");return n(),v(h,null,[d(x(k),{visible:e.visible,onCancel:O,width:"420px",closable:!1,footer:null,mask:!1,"onUpdate:visible":l[0]||(l[0]=e=>L("update:visible",e))},{title:r((()=>[c("div",{ref_key:"modalTitleRef",ref:D,style:{width:"100%",cursor:"move"}},[p(" 选择图标 "),j],512)])),modalRender:r((({originVNode:e})=>[c("div",{style:m(K.value)},[(n(),f(b(e)))],4)])),default:r((()=>[c("div",I,[c("div",R,[(n(!0),v(h,null,g(new Array(e.iconB64List.length-1).toString().split(","),((a,l)=>(n(),v("div",{class:y($.value?"edit-icon":"medium-icon"),style:m({background:`url(${e.iconB64List[l+1]}) 0 0 no-repeat`,backgroundSize:"50px 50px"}),onClick:e=>{return a=l,void($.value?(z.value.show=!0,z.value.selected=a+1):(_.cell.icon=a+1,L("update:visible",!1)));var a}},null,14,A)))),256)),d(i,{class:"add-icon",style:{padding:"10px",width:"100%"}},{default:r((()=>[d(t,{type:$.value?"danger":"success",onClick:U},{default:r((()=>[p(w($.value?"完成":"替换图标"),1)])),_:1},8,["type"]),d(t,{type:"primary",onClick:P},{default:r((()=>[p("添加10个空图标")])),_:1})])),_:1})])])])),_:1},8,["visible"]),d(M,{uploader:z.value,iconB64List:e.iconB64List},null,8,["uploader","iconB64List"])],64)}}}),[["__scopeId","data-v-2d6b3d56"]]);export{S as default};
