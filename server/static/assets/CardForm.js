var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(r,t,o)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o;import{a as l,b as d,p as s,U as p,r as c,I as m,e as u,o as f,i as j,j as y,v,m as b,f as C,V as g,k as x,F as k,W as w,u as F}from"./index.js";import{B as O}from"./BasicForm.js";import"./PathSelect.js";import"./index4.js";import"./find.js";import"./_baseIteratee.js";import"./get.js";import"./index5.js";import"./index6.js";import"./useFormItem.js";import"./index3.js";import"./transButton.js";import"./index2.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./upperFirst.js";import"./download.js";import"./index7.js";import"./index8.js";import"./uniqBy.js";const P=d({name:"CardForm",components:{BasicForm:O},props:{card:s.object.isRequired.type,form:s.object.isRequired.type,isDefault:s.bool.def(!1),allowFold:s.bool.def(!1),defaultFold:s.bool.def(!1)},emits:["redo","submit","addCard","delCard"],setup(e,{emit:l}){const{createPrompt:d}=F(),{prefixCls:s}=p("card-form"),u=c(!!e.defaultFold),f=m((()=>{return r=e.card,t=e.form,r.title.replace(/{{([^}]+)}}/g,((e,o)=>new Function("card","form",`return ${o}`)(r,t)));var r,t})),j=m((()=>{var r,t;return null!=(t=null==(r=e.card)?void 0:r.addBtnText)?t:"新增"}));return{emit:l,prefixCls:s,folded:u,cardTitle:f,addBtnText:j,onClickTitle:function(){e.allowFold&&(u.value=!u.value)},onAddCard:function(){var s,p;d((p=((e,r)=>{for(var t in r||(r={}))a.call(r,t)&&n(e,t,r[t]);if(o)for(var t of o(r))i.call(r,t)&&n(e,t,r[t]);return e})({title:j.value,required:!0},null==(s=e.card)?void 0:s.promptProps),r(p,t({onOk(r){return t=this,o=null,a=function*(){l("addCard",{form:e.form,key:r})},new Promise(((e,r)=>{var i=e=>{try{l(a.next(e))}catch(t){r(t)}},n=e=>{try{l(a.throw(e))}catch(t){r(t)}},l=r=>r.done?e(r.value):Promise.resolve(r.value).then(i,n);l((a=a.apply(t,o)).next())}));var t,o,a}}))))},onRemoveCard:function(){l("delCard",{form:e.form})}}}}),B={key:0,style:{"margin-left":"8px"}},T={style:{"text-align":"center"}},_=v("span",null,"保存",-1),h=v("span",null,"删除当前配置",-1);var R=l(P,[["render",function(e,r,t,o,a,i){const n=u("icon"),l=u("a-tooltip"),d=u("BasicForm"),s=u("a-button"),p=u("a-divider"),c=u("a-popconfirm"),m=u("a-spin"),F=u("a-card");return f(),j(F,{class:w([e.prefixCls,{"allow-fold":e.allowFold,folded:e.folded}]),bordered:!1},{title:y((()=>[v("div",{class:"card-title",onClick:r[0]||(r[0]=(...r)=>e.onClickTitle&&e.onClickTitle(...r))},[v("span",null,b(e.cardTitle),1),e.allowFold?(f(),C("span",B,[e.folded?(f(),j(n,{key:0,icon:"ant-design:caret-down"})):(f(),j(n,{key:1,icon:"ant-design:caret-up"}))])):g("",!0)])])),extra:y((()=>[x(l,{title:"刷新"},{default:y((()=>[x(n,{icon:"ant-design:redo",style:{cursor:"pointer"},onClick:r[1]||(r[1]=()=>e.emit("redo",e.form))})])),_:1})])),default:y((()=>[x(m,{spinning:e.form.loading},{default:y((()=>[x(d,{onRegister:e.form.register},null,8,["onRegister"]),v("div",T,[x(s,{type:"primary","pre-icon":"ant-design:save",onClick:r[2]||(r[2]=()=>e.emit("submit",e.form))},{default:y((()=>[_])),_:1}),e.isDefault?(f(),C(k,{key:0},[x(p,{type:"vertical"}),e.card.allowAdd?(f(),j(s,{key:0,"pre-icon":"ant-design:plus",onClick:e.onAddCard},{default:y((()=>[v("span",null,b(e.addBtnText),1)])),_:1},8,["onClick"])):g("",!0)],64)):(f(),C(k,{key:1},[x(p,{type:"vertical"}),x(c,{title:"确定要删除当前配置吗？",onConfirm:e.onRemoveCard},{default:y((()=>[e.card.allowDel?(f(),j(s,{key:0,"pre-icon":"ant-design:minus",danger:""},{default:y((()=>[h])),_:1})):g("",!0)])),_:1},8,["onConfirm"])],64))])])),_:1},8,["spinning"])])),_:1},8,["class"])}]]);export{R as default};
