import{a as e,b as a,r as l,f_ as t,w as s,z as i,I as o,e as u,o as n,f as v,k as r,j as c,v as d,l as p,O as m,i as f,da as g,F as b,h,W as y,m as w,X as k,s as x,M as B,f$ as _,d0 as L,d1 as C,aL as M}from"./index.js";import j from"./IconUploader.js";import"./esm.js";const S=(e=>(L("data-v-0464cc02"),e=e(),C(),e))((()=>d("span",{class:"tip"},"按住这里可拖动",-1))),$={class:"icon-view-wrap"},I={class:"icon-view"},R=["onClick"];var A=e(a({__name:"SelectIconModal",props:{visible:Boolean,cell:Object,iconB64List:Array},emits:["update:visible"],setup(e,{emit:a}){const L=e,C=a,{createMessage:A}=M(),z=l(!1),O=l({show:!1,selected:null}),U=()=>{C("update:visible",!1)},D=()=>{z.value=!z.value,z.value&&_.info("请点击想要替换的图标")},F=l(null),{x:N,y:T,isDragging:V}=t(F),W=l(0),X=l(0),q=l(!1),E=l(0),G=l(0),H=l(0),J=l(0),K=l({left:0,right:0,top:0,bottom:0});s([N,T],(()=>{if(!q.value){W.value=N.value,X.value=T.value;const e=document.body.getBoundingClientRect(),a=F.value.getBoundingClientRect();K.value.right=e.width-a.width,K.value.bottom=e.height-a.height,H.value=E.value,J.value=G.value}q.value=!0})),s(V,(()=>{V||(q.value=!1)})),i((()=>{q.value&&(E.value=H.value+Math.min(Math.max(K.value.left,N.value),K.value.right)-W.value,G.value=J.value+Math.min(Math.max(K.value.top,T.value),K.value.bottom)-X.value)}));const P=o((()=>({transform:`translate(${E.value}px, ${G.value}px)`})));function Q(){let e=L.iconB64List,a=!1;for(let l=1;l<e.length;l++)if(!e[l]){a=!0;break}a?A.warn("仍有未利用的空白图标，无法继续添加"):e.push(...Array(10).fill(""))}return(a,l)=>{const t=u("a-button"),s=u("a-space");return n(),v(b,null,[r(x(B),k({visible:e.visible,onCancel:U,width:"420px",closable:!1,footer:null,maskStyle:{background:"rgba(0, 0, 0, 0.1)"}},a.$attrs,{"onUpdate:visible":l[0]||(l[0]=e=>C("update:visible",e))}),{title:c((()=>[d("div",{ref_key:"modalTitleRef",ref:F,style:{width:"100%",cursor:"move"}},[p(" 选择图标 "),S],512)])),modalRender:c((({originVNode:e})=>[d("div",{style:m(P.value)},[(n(),f(g(e)))],4)])),default:c((()=>[d("div",$,[d("div",I,[(n(!0),v(b,null,h(new Array(e.iconB64List.length-1).toString().split(","),((a,l)=>(n(),v("div",{class:y(z.value?"edit-icon":"medium-icon"),style:m({background:`url(${e.iconB64List[l+1]}) 0 0 no-repeat`,backgroundSize:"50px 50px"}),onClick:e=>{return a=l,void(z.value?(O.value.show=!0,O.value.selected=a+1):(L.cell.icon=a+1,C("update:visible",!1)));var a}},null,14,R)))),256)),r(s,{class:"add-icon",style:{padding:"10px",width:"100%"}},{default:c((()=>[r(t,{type:z.value?"danger":"success",onClick:D},{default:c((()=>[p(w(z.value?"完成":"替换图标"),1)])),_:1},8,["type"]),r(t,{type:"primary",onClick:Q},{default:c((()=>[p("添加10个空图标")])),_:1})])),_:1})])])])),_:1},16,["visible","maskStyle"]),r(j,{uploader:O.value,iconB64List:e.iconB64List},null,8,["uploader","iconB64List"])],64)}}}),[["__scopeId","data-v-0464cc02"]]);export{A as default};
