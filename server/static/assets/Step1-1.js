var e=(e,t,a)=>new Promise(((l,i)=>{var n=e=>{try{o(a.next(e))}catch(t){i(t)}},s=e=>{try{o(a.throw(e))}catch(t){i(t)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,s);o((a=a.apply(e,t)).next())}));import{b as t,r as a,d6 as l,e as i,o as n,i as s,j as o,k as r,x as u,ae as d,l as p,u as c,a as m,f,F as v,w as y,c as h,bD as _,da as j,af as g}from"./index.js";import{a as x}from"./hooks.js";import{u as k,B as b,a as S}from"./index2.js";/* empty css      *//* empty css                                                      */import{T as P}from"./BasicForm.js";import w from"./ModeBox.js";import B from"./StepBtn.js";import"./lodash.default.js";import"./upperFirst.js";import"./_baseIteratee.js";import"./get.js";import"./find.js";import"./throttle.js";import"./merge.js";import"./uniqBy.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./index4.js";import"./index5.js";import"./index6.js";import"./useFormItem.js";import"./transButton.js";import"./download.js";import"./index7.js";import"./index8.js";const M=["innerHTML"],R=p("创建新目录"),F=p("取消"),C=p("确定"),D=t({__name:"PathSelectModal",emits:["select","register"],setup(t,{emit:p}){const m=P.DirectoryTree,{createPrompt:f}=c(),v=a(!0),y=a([]),h=a(""),_=a(),j=a(""),[g,{closeModal:x}]=k((t=>e(this,null,(function*(){j.value=t.title,0===y.value.length&&function(){e(this,null,(function*(){try{v.value=!0,y.value=yield l.get({url:"/sys/fs/tree/root"})}finally{v.value=!1}}))}()}))));function S(){_.value&&p("select",_.value.dataRef.path),x()}function w(){x()}function B(t){return e(this,null,(function*(){t.dataRef.children||G(t.dataRef.path,t)}))}function D(e,{node:t}){h.value=e[0],_.value=t}function L(){if(_.value){let t=_.value.dataRef.path;f({title:"请输入新目录名称",required:!0,onOk(a){return e(this,null,(function*(){v.value=!0;try{yield l.put({url:"/sys/fs/create-dir",params:{path:t,name:a}}),yield G(t,_.value)}finally{v.value=!1}}))}})}}function G(t,a){return e(this,null,(function*(){let e={path:t};a.dataRef.children=yield l.get({url:"/sys/fs/tree/children",params:e}),y.value=[...y.value]}))}return(e,t)=>{const a=i("a-spin"),l=i("a-button"),p=i("a-col"),c=i("a-row");return n(),s(u(b),{onRegister:u(g),title:j.value,width:500,onOk:S,onCancel:w},{footer:o((()=>[r(c,{type:"flex",justify:"space-between"},{default:o((()=>[r(p,null,{default:o((()=>[r(l,{type:"primary",disabled:!_.value,onClick:L},{default:o((()=>[R])),_:1},8,["disabled"])])),_:1}),r(p,null,{default:o((()=>[r(l,{onClick:w},{default:o((()=>[F])),_:1}),r(l,{type:"primary",onClick:S},{default:o((()=>[C])),_:1})])),_:1})])),_:1})])),default:o((()=>[r(a,{spinning:v.value},{default:o((()=>[r(u(m),{treeData:y.value,loadData:B,expandAction:"dblclick",onSelect:D},{title:o((({title:e,key:t})=>[d("span",{innerHTML:e},null,8,M)])),_:1},8,["treeData"])])),_:1},8,["spinning"])])),_:1},8,["onRegister","title"])}}});var L=m(t({__name:"PathSelect",props:{value:String,title:{type:String,default:"选择目录"},onlyDir:{type:Boolean,default:!0},beforeSelect:Function},emits:["update:value"],setup(e,{emit:t}){const a=e,[l,{openModal:s}]=S();function p(){s(!0,a)}function c(e){"function"==typeof a.beforeSelect&&(e=a.beforeSelect(e)),m(e)}function m(e){t("update:value",e)}return(t,a)=>{const s=i("a-input");return n(),f(v,null,[r(s,{class:"file-select-input",value:e.value,placeholder:e.title,"onUpdate:value":m},{addonAfter:o((()=>[d("span",{onClick:p,style:{cursor:"pointer"}},"选择")])),_:1},8,["value","placeholder"]),r(D,{onRegister:u(l),onSelect:c},null,8,["onRegister"])],64)}}}),[["__scopeId","data-v-788508d6"]]);const G={class:"step-box"},U=d("div",{class:"step-tip"},"请选择安装V3云崽的方式",-1),A={key:"trans-git"},T={class:"lite-form"},z={key:"trans-input",class:"lite-form"},I={key:2},O=t({__name:"Step1-1",emits:["prev","next"],setup(e,{emit:t}){const{createMessage:a}=g(),[l,{models:i}]=x({nextBtn:{},prevBtn:{disabled:!0},nextCheck:()=>!!i.value.installPath||(a.warn("请选择目录"),!1)},{emit:t});y((()=>i.value.installPath),(e=>{}),{immediate:!0});const s=h({install:[{key:"new",title:"全新下载",desc:"从Git上全新克隆一个项目",recommended:!0},{key:"exist",title:"选择已有",desc:"选择本地已有的项目"}],git:[{key:"gitee",title:"Gitee",desc:"使用Gitee克隆项目",recommended:!0},{key:"github",title:"Github",desc:"使用Github克隆项目"}]});function p(e){if(e&&!/Yunzai-Bot[\\/]?$/i.test(e)){let t=/\\/.test(e)?"\\":"/";return t=e.endsWith(t)?"":t,e+t+"Yunzai-Bot"}return e}return(e,t)=>(n(),f("div",G,[U,r(j,{name:"fade-slide",mode:"out-in",appear:""},{default:o((()=>[r(w,{active:u(i).installMode,"onUpdate:active":t[0]||(t[0]=e=>u(i).installMode=e),modeList:s.install,key:"trans-install"},null,8,["active","modeList"]),r(_,{name:"fade-slide",mode:"out-in",appear:"",key:"trans-1"},{default:o((()=>["new"===u(i).installMode?(n(),f("div",A,[r(w,{active:u(i).gitAddress,"onUpdate:active":t[1]||(t[1]=e=>u(i).gitAddress=e),modeList:s.git},null,8,["active","modeList"]),d("div",T,[r(u(L),{value:u(i).installPath,"onUpdate:value":t[2]||(t[2]=e=>u(i).installPath=e),title:"选择安装目录",beforeSelect:p},null,8,["value"])])])):"exist"===u(i).installMode?(n(),f("div",z,[r(u(L),{value:u(i).installPath,"onUpdate:value":t[3]||(t[3]=e=>u(i).installPath=e),title:"选择V3云崽地址"},null,8,["value"])])):(n(),f("span",I))])),_:1})])),_:1}),r(B,{onRegister:u(l)},null,8,["onRegister"])]))}});export{O as default};
