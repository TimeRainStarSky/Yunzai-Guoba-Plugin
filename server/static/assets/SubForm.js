var e=Object.defineProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,l,o)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,a=(e,t,l)=>new Promise(((o,n)=>{var a=e=>{try{s(l.next(e))}catch(t){n(t)}},r=e=>{try{s(l.throw(e))}catch(t){n(t)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(a,r);s((l=l.apply(e,t)).next())}));import{k as r,ac as s,b as i,p as u,ad as d,r as c,e as p,o as m,f as v,F as f,h as y,ae as b,m as g,R as h,x as j,U as k,af as w,ag as O,G as P,i as R,j as x,V as _,l as A,Q as C,w as F,ah as S}from"./index.js";import{u as M,B,a as I}from"./index2.js";import{B as U}from"./BasicForm.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./index4.js";import"./find.js";import"./_baseIteratee.js";import"./get.js";import"./index5.js";import"./index6.js";import"./useFormItem.js";/* empty css      */import"./transButton.js";import"./upperFirst.js";import"./download.js";import"./index7.js";import"./index8.js";import"./uniqBy.js";var z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z"}}]},name:"minus-circle",theme:"filled"};function G(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),o.forEach((function(t){H(e,t,l[t])}))}return e}function H(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var D=function(e,t){var l=G({},e,t.attrs);return r(s,G({},l,{icon:z}),null)};D.displayName="MinusCircleFilled",D.inheritAttrs=!1;var E=D;const V=Symbol(),W=Symbol();const $={key:0,class:"card-item"},q={class:"label"},L={class:"value"},N=i({__name:"SettingCard",props:{models:u.object.def((()=>({}))),allowRemove:u.bool.def(!1)},emits:["remove"],setup(e,{emit:t}){const l=d(W),o=d(V,c([])),{createConfirmSync:n}=w();function s(e){return a(this,null,(function*(){e.stopPropagation(),(yield n({title:"删除",content:"确定删除吗？"}))&&t("remove")}))}return(t,n)=>{const a=p("GSpan");return m(),v("div",{class:k([`${j(l)}-card`])},[(m(!0),v(f,null,y(j(o),(t=>(m(),v(f,null,["Divider"!==t.component?(m(),v("div",$,[b("div",q,g(t.label),1),b("div",L,[r(a,{value:e.models[t.field],password:"InputPassword"===t.component},null,8,["value","password"])])])):h("",!0)],64)))),256)),e.allowRemove?(m(),v("div",{key:0,class:"remove",onClick:s},[r(j(E))])):h("",!0)],2)}}}),Q=i({__name:"SubFormModal",props:{modalProps:{type:Object,default:()=>({})}},emits:["register","ok"],setup(e,{emit:s}){const i=e,u=d(V,c([])),p=c(null),[v,f]=M((function(e){return a(this,null,(function*(){p.value=e.payload,yield b.resetFields(),yield b.setFieldsValue(e.models)}))})),[y,b]=O({labelWidth:120,schemas:u,labelAlign:"right",showActionButtonGroup:!1,baseColProps:{span:24}}),g=P((()=>((e,a)=>{for(var r in a||(a={}))l.call(a,r)&&n(e,r,a[r]);if(t)for(var r of t(a))o.call(a,r)&&n(e,r,a[r]);return e})({title:"子表单",width:800,minHeight:100,onOk:h},i.modalProps)));function h(){return a(this,null,(function*(){let e=yield b.validate();s("ok",{values:e,payload:p.value}),f.closeModal()}))}return(e,t)=>(m(),R(j(B),_(j(g),{onRegister:j(v)}),{default:x((()=>[r(j(U),{onRegister:j(y)},null,8,["onRegister"])])),_:1},16,["onRegister"]))}}),J={style:{padding:"10px"}},K=A("新增"),T=A("关闭"),X=i({__name:"FormListModal",props:{modalProps:{type:Object,default:()=>({})}},emits:["register","ok"],setup(e,{emit:t}){const l=c([]),[o,n]=M((function(e){return a(this,null,(function*(){l.value=e.list}))})),[s,i]=I(),u=P((()=>({title:"填写列表",width:800,minHeight:400,onOk:g})));function d(){w({})}function g(){return a(this,null,(function*(){t("ok",l.value),n.closeModal()}))}function k(){n.closeModal()}function w(e,t){t=t||{isUpdate:!1},i.openModal(!0,{models:e,payload:t})}function O({values:e,payload:{isUpdate:o,modelIndex:n}}){o?l.value[n]=e:l.value.push(e),t("ok",l.value)}return(n,a)=>{const i=p("a-empty"),c=p("a-button"),g=p("a-col"),P=p("a-row");return m(),v(f,null,[r(j(B),_(j(u),{onRegister:j(o)}),{footer:x((()=>[r(P,{type:"flex",justify:"space-between"},{default:x((()=>[r(g,null,{default:x((()=>[r(c,{type:"primary",preIcon:"ant-design:plus",onClick:d},{default:x((()=>[K])),_:1})])),_:1}),r(g,null,{default:x((()=>[r(c,{onClick:k},{default:x((()=>[T])),_:1})])),_:1})])),_:1})])),default:x((()=>[b("div",J,[0===l.value.length?(m(),R(i,{key:0,description:"暂无数据，请点击下方的“新增”按钮添加"})):h("",!0),(m(!0),v(f,null,y(l.value,((e,o)=>(m(),R(N,{models:e,allowRemove:"",onClick:t=>function(e,t){w(e,{modelIndex:t,isUpdate:!0})}(e,o),onRemove:e=>{return n=o,l.value.splice(n,1),void t("ok",l.value);var n}},null,8,["models","onClick","onRemove"])))),256))])])),_:1},16,["onRegister"]),r(Q,{modalProps:e.modalProps,onRegister:j(s),onOk:O},null,8,["modalProps","onRegister"])],64)}}});const Y=i({__name:"SubForm",props:{value:{type:[Array,Object]},schemas:{type:Array,default:()=>[]},multiple:u.bool.def(!1),alwaysArray:u.bool.def(!1),modalProps:{type:Object,default:()=>({})}},emits:["change","update:value"],setup(e,{emit:t}){const l=e,{prefixCls:o}=C("g-sub-form"),n=c(),a=P((()=>l.schemas)),s=P((()=>l.alwaysArray||l.multiple)),i=P((()=>{const{value:e,multiple:t}=l;if(null==e||0===e.length)return s.value?[]:{};if(t){if(!Array.isArray(e))return[e]}else if(s.value&&!Array.isArray(e))return[e];return e})),u=P((()=>{var e;return null!=(e=Array.isArray(i.value)?i.value[0]:i.value)?e:{}})),d=P((()=>{var e,t;const{multiple:o}=l;return o?`已配置 ${null!=(t=null==(e=i.value)?void 0:e.length)?t:0} 项`:""}));F(n,(()=>{var e;const t=null==(e=n.value)?void 0:e.input;t&&t.setAttribute("readonly","readonly")}),{immediate:!0});const[f,y]=I();function b(){y.openModal(!0,{list:i.value})}function g(e){t("change",e)}const[h,w]=I();function O(){w.openModal(!0,{models:u.value})}function R({values:e}){s.value&&(e=[e]),t("change",e)}return S(W,o),S(V,a),(t,l)=>{const a=p("a-input");return m(),v("div",{class:k([j(o)])},[e.multiple?(m(),v("div",{key:0,class:"multiple-mode",onClick:b},[r(a,{ref_key:"inputRef",ref:n,value:j(d)},null,8,["value"])])):(m(),v("div",{key:1,class:"single-mode",onClick:O},[r(N,{models:j(u)},null,8,["models"])])),r(X,{modalProps:e.modalProps,onRegister:j(f),onOk:g},null,8,["modalProps","onRegister"]),r(Q,{modalProps:e.modalProps,onRegister:j(h),onOk:R},null,8,["modalProps","onRegister"])],2)}}});export{Y as default};
