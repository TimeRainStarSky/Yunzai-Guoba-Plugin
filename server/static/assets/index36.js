var e=(e,o,t)=>new Promise(((s,a)=>{var r=e=>{try{i(t.next(e))}catch(o){a(o)}},n=e=>{try{i(t.throw(e))}catch(o){a(o)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,n);i((t=t.apply(e,o)).next())}));import{b as o,bT as t,bR as s,c_ as a,c$ as r,p as n,U as i,d9 as l,I as c,y as d,cZ as u,g4 as p,k as m,l as f,fU as g,aL as k,a as y,e as h,o as x,f as w,j,i as _,V as b,v,W as C,m as I,F as D}from"./index.js";import{D as L}from"./siteSetting.js";import{u as M}from"./index10.js";import{a as U}from"./index2.js";import{h as O}from"./header.js";import{a as P}from"./common.js";import"./PluginIcon.js";import"./FullscreenOutlined.js";import"./index12.js";import"./useWindowSizeFn.js";import"./useContentViewHeight.js";import"./uniqBy.js";import"./_baseIteratee.js";import"./get.js";import"./index11.js";import"./RedoOutlined.js";import"./lock.js";var R=y(o({name:"UserDropdown",components:{Dropdown:t,Menu:s,MenuItem:a((()=>r((()=>import("./DropMenuItem.js")),["assets/DropMenuItem.js","assets/index.js","assets/index25.css"]))),MenuDivider:s.Divider,LockAction:a((()=>r((()=>import("./LockModal.js")),["assets/LockModal.js","assets/LockModal.css","assets/index.js","assets/index25.css","assets/index2.js","assets/index3.css","assets/useWindowSizeFn.js","assets/FullscreenOutlined.js","assets/BasicForm.js","assets/BasicForm.css","assets/index4.js","assets/index21.css","assets/find.js","assets/_baseIteratee.js","assets/get.js","assets/index5.js","assets/index24.css","assets/index6.js","assets/index18.css","assets/useFormItem.js","assets/index3.js","assets/index15.css","assets/DeleteOutlined.js","assets/transButton.js","assets/upperFirst.js","assets/download.js","assets/index7.js","assets/index9.css","assets/index8.js","assets/index7.css","assets/uniqBy.js","assets/lock.js","assets/header.js"])))},props:{theme:n.oneOf(["dark","light"])},setup(){const{prefixCls:o}=i("header-user-dropdown"),{t:t}=d(),{getShowDoc:s,getUseLockPage:a}=M(),r=l(),n=c((()=>{const{realName:e="",avatar:o,desc:t,userId:s}=r.getUserInfo||{};return{realName:e,avatar:o||O,desc:t,userId:s}})),[y,{openModal:h}]=U();const{createConfirm:x}=k();return{prefixCls:o,t:t,getUserInfo:n,handleMenuClick:function(o){switch(o.key){case"logout":r.confirmLoginOut();break;case"doc":u(L);break;case"lock":h(!0);break;case"restart-bot":x({title:"重启",iconType:"warning",content:"确定要立即重启Bot吗？",onOk(){return e(this,null,(function*(){yield p.doRestart(),yield P(5e3),window.location.reload()}))}});break;case"restart-guoba":x({title:"重启",iconType:"warning",content:m("div",null,[m("p",{style:"color: #333"},[f("确定要立即重启Guoba吗？")]),m("p",{style:"color: #999"},[f("不会重启Bot")])]),onOk(){return e(this,null,(function*(){yield g.doRestartGuoba(),yield P(1e3),window.location.reload()}))}})}},getShowDoc:s,register:y,getUseLockPage:a}}}),[["render",function(e,o,t,s,a,r){const n=h("GAvatar"),i=h("MenuDivider"),l=h("MenuItem"),c=h("Menu"),d=h("Dropdown"),u=h("LockAction");return x(),w(D,null,[m(d,{placement:"bottomLeft",overlayClassName:`${e.prefixCls}-dropdown-overlay`},{overlay:j((()=>[m(c,{onClick:e.handleMenuClick},{default:j((()=>[e.getShowDoc?(x(),_(i,{key:0})):b("",!0),e.getUseLockPage?(x(),_(l,{key:"lock",text:e.t("layout.header.tooltipLock"),icon:"ion:lock-closed-outline"},null,8,["text"])):b("",!0),m(l,{key:"logout",text:e.t("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"]),m(i),m(l,{key:"restart-guoba",text:"重启Guoba",icon:"solar:restart-bold"}),m(l,{key:"restart-bot",text:"重启Bot",icon:"solar:restart-bold"})])),_:1},8,["onClick"])])),default:j((()=>[v("span",{class:C([[e.prefixCls,`${e.prefixCls}--${e.theme}`],"flex"])},[m(n,{class:C(`${e.prefixCls}__header`),id:e.getUserInfo.userId,qs:100,size:24},null,8,["class","id"]),v("span",{class:C(`${e.prefixCls}__info hidden md:block`)},[v("span",{class:C([`${e.prefixCls}__name  `,"truncate"])},I(e.getUserInfo.realName),3)],2)],2)])),_:1},8,["overlayClassName"]),m(u,{onRegister:e.register},null,8,["onRegister"])],64)}]]);export{R as default};
